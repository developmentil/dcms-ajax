/** @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 0.8.1 - Build: 266 (2012/07/31 03:33 PM)
 */

/** @license
 * DCMS-Ajax <http://www.dcms.co.il/>
 * Copyright (C) Development IL - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * @Author Moshe Simantov
 * @Version 0.1.0
 */

/**
 * @license RequireJS i18n 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/i18n for details
 */

!function(t){"function"==typeof define&&define.amd?define("core/libs/sammy",["jquery"],t):$.sammy=window.Sammy=t($)}(function(t){var e,n="([^/]+)",i=/:([\w\d]+)/g,r=/\?([^#]*)?$/,o=function(t){return Array.prototype.slice.call(t)},s=function(t){return"[object Function]"===Object.prototype.toString.call(t)},a=function(t){return"[object Array]"===Object.prototype.toString.call(t)},u=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},c=function(t){return decodeURIComponent((t||"").replace(/\+/g," "))},l=encodeURIComponent,p=function(t){return String(t).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},d=function(t){return function(){return this.route.apply(this,[t].concat(Array.prototype.slice.call(arguments)))}},h={},f=!(!window.history||!history.pushState),g=[];return e=function(){var n,i,r=o(arguments);return e.apps=e.apps||{},0===r.length||r[0]&&s(r[0])?e.apply(e,["body"].concat(r)):"string"==typeof(i=r.shift())?(n=e.apps[i]||new e.Application,n.element_selector=i,r.length>0&&t.each(r,function(t,e){n.use(e)}),n.element_selector!=i&&delete e.apps[i],e.apps[n.element_selector]=n,n):void 0},e.VERSION="0.7.4",e.addLogger=function(t){g.push(t)},e.log=function(){var n=o(arguments);n.unshift("["+Date()+"]"),t.each(g,function(t,i){i.apply(e,n)})},"undefined"!=typeof window.console?s(window.console.log.apply)?e.addLogger(function(){window.console.log.apply(window.console,arguments)}):e.addLogger(function(){window.console.log(arguments)}):"undefined"!=typeof console&&e.addLogger(function(){console.log.apply(console,arguments)}),t.extend(e,{makeArray:o,isFunction:s,isArray:a}),e.Object=function(e){return t.extend(this,e||{})},t.extend(e.Object.prototype,{escapeHTML:p,h:p,toHash:function(){var e={};return t.each(this,function(t,n){s(n)||(e[t]=n)}),e},toHTML:function(){var e="";return t.each(this,function(t,n){s(n)||(e+="<strong>"+t+"</strong> "+n+"<br />")}),e},keys:function(t){var e=[];for(var n in this)s(this[n])&&t||e.push(n);return e},has:function(e){return this[e]&&""!==t.trim(this[e].toString())},join:function(){var t=o(arguments),e=t.shift();return t.join(e)},log:function(){e.log.apply(e,arguments)},toString:function(e){var n=[];return t.each(this,function(t,i){(!s(i)||e)&&n.push('"'+t+'": '+i.toString())}),"Sammy.Object: {"+n.join(",")+"}"}}),e.targetIsThisWindow=function(e){var n=t(e.target).attr("target");return n&&n!==window.name&&"_self"!==n?"_blank"===n?!1:"top"===n&&window===window.top?!0:!1:!0},e.DefaultLocationProxy=function(t,e){this.app=t,this.is_native=!1,this.has_history=f,this._startPolling(e)},e.DefaultLocationProxy.fullPath=function(t){var e=t.toString().match(/^[^#]*(#.+)$/),n=e?e[1]:"";return[t.pathname,t.search,n].join("")},t.extend(e.DefaultLocationProxy.prototype,{bind:function(){var n=this,i=this.app,r=e.DefaultLocationProxy;t(window).bind("hashchange."+this.app.eventNamespace(),function(t,e){n.is_native!==!1||e||(n.is_native=!0,window.clearInterval(r._interval),r._interval=null),i.trigger("location-changed")}),f&&!i.disable_push_state&&(t(window).bind("popstate."+this.app.eventNamespace(),function(){i.trigger("location-changed")}),t(document).delegate("a","click.history-"+this.app.eventNamespace(),function(t){if(!(t.isDefaultPrevented()||t.metaKey||t.ctrlKey)){var o=r.fullPath(this),s=this.hostname?this.hostname:function(t){var e=document.createElement("a");return e.href=t.href,e.hostname}(this);return s==window.location.hostname&&i.lookupRoute("get",o)&&e.targetIsThisWindow(t)?(t.preventDefault(),n.setLocation(o),!1):void 0}})),r._bindings||(r._bindings=0),r._bindings++},unbind:function(){t(window).unbind("hashchange."+this.app.eventNamespace()),t(window).unbind("popstate."+this.app.eventNamespace()),t(document).undelegate("a","click.history-"+this.app.eventNamespace()),e.DefaultLocationProxy._bindings--,e.DefaultLocationProxy._bindings<=0&&(window.clearInterval(e.DefaultLocationProxy._interval),e.DefaultLocationProxy._interval=null)},getLocation:function(){return e.DefaultLocationProxy.fullPath(window.location)},setLocation:function(t){if(/^([^#\/]|$)/.test(t)&&(t=f&&!this.app.disable_push_state?"/"+t:"#!/"+t),t!=this.getLocation()){if(!f||this.app.disable_push_state||!/^\//.test(t))return window.location=t;history.pushState({path:t},window.title,t),this.app.trigger("location-changed")}},_startPolling:function(n){var i=this;if(!e.DefaultLocationProxy._interval){n||(n=10);var r=function(){var n=i.getLocation();("undefined"==typeof e.DefaultLocationProxy._last_location||n!=e.DefaultLocationProxy._last_location)&&window.setTimeout(function(){t(window).trigger("hashchange",[!0])},0),e.DefaultLocationProxy._last_location=n};r(),e.DefaultLocationProxy._interval=window.setInterval(r,n)}}}),e.Application=function(t){var n=this;this.routes={},this.listeners=new e.Object({}),this.arounds=[],this.befores=[],this.namespace=(new Date).getTime()+"-"+parseInt(1e3*Math.random(),10),this.context_prototype=function(){e.EventContext.apply(this,arguments)},this.context_prototype.prototype=new e.EventContext,s(t)&&t.apply(this,[this]),this._location_proxy||this.setLocationProxy(new e.DefaultLocationProxy(this,this.run_interval_every)),this.debug&&this.bindToAllEvents(function(t,e){n.log(n.toString(),t.cleaned_type,e||{})})},e.Application.prototype=t.extend({},e.Object.prototype,{ROUTE_VERBS:["get","post","put","delete"],APP_EVENTS:["run","unload","lookup-route","run-route","route-found","event-context-before","event-context-after","changed","error","check-form-submission","redirect","location-changed"],_last_route:null,_location_proxy:null,_running:!1,element_selector:"body",debug:!1,raise_errors:!1,run_interval_every:50,disable_push_state:!1,template_engine:null,toString:function(){return"Sammy.Application:"+this.element_selector},$element:function(e){return e?t(this.element_selector).find(e):t(this.element_selector)},use:function(){var t=o(arguments),n=t.shift(),i=n||"";try{t.unshift(this),"string"==typeof n&&(i="Sammy."+n,n=e[n]),n.apply(this,t)}catch(r){"undefined"==typeof n?this.error("Plugin Error: called use() but plugin ("+i.toString()+") is not defined",r):s(n)?this.error("Plugin Error",r):this.error("Plugin Error: called use() but '"+i.toString()+"' is not a function",r)}return this},setLocationProxy:function(t){var e=this._location_proxy;this._location_proxy=t,this.isRunning()&&(e&&e.unbind(),this._location_proxy.bind())},log:function(){e.log.apply(e,Array.prototype.concat.apply([this.element_selector],arguments))},route:function(e,r){var o,a,u=this,c=[],l=Array.prototype.slice.call(arguments,2);if(0===l.length&&s(r)&&(r=e,l=[r],e="any"),e=e.toLowerCase(),r.constructor==String){for(i.lastIndex=0;null!==(a=i.exec(r));)c.push(a[1]);r=new RegExp(r.replace(i,n)+"$")}return t.each(l,function(t,e){"string"==typeof e&&(l[t]=u[e])}),o=function(t){var e={verb:t,path:r,callback:l,param_names:c};u.routes[t]=u.routes[t]||[],u.routes[t].push(e)},"any"===e?t.each(this.ROUTE_VERBS,function(t,e){o(e)}):o(e),this},get:d("get"),post:d("post"),put:d("put"),del:d("delete"),any:d("any"),mapRoutes:function(e){var n=this;return t.each(e,function(t,e){n.route.apply(n,e)}),this},eventNamespace:function(){return["sammy-app",this.namespace].join("-")},bind:function(t,e,n){var i=this;"undefined"==typeof n&&(n=e);var r=function(){var t,e,r;t=arguments[0],r=arguments[1],r&&r.context?(e=r.context,delete r.context):e=new i.context_prototype(i,"bind",t.type,r,t.target),t.cleaned_type=t.type.replace(i.eventNamespace(),""),n.apply(e,[t,r])};return this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r),this.isRunning()&&this._listen(t,r),this},trigger:function(t,e){return this.$element().trigger([t,this.eventNamespace()].join("."),[e]),this},refresh:function(){return this.last_location=null,this.trigger("location-changed"),this},before:function(t,e){return s(t)&&(e=t,t={}),this.befores.push([t,e]),this},after:function(t){return this.bind("event-context-after",t)},around:function(t){return this.arounds.push(t),this},onComplete:function(t){return this._onComplete=t,this},isRunning:function(){return this._running},helpers:function(e){return t.extend(this.context_prototype.prototype,e),this},helper:function(t,e){return this.context_prototype.prototype[t]=e,this},run:function(n){if(this.isRunning())return!1;var i=this;return t.each(this.listeners.toHash(),function(e,n){t.each(n,function(t,n){i._listen(e,n)})}),this.trigger("run",{start_url:n}),this._running=!0,this.last_location=null,/\#(.+)/.test(this.getLocation())||"undefined"==typeof n||this.setLocation(n),this._checkLocation(),this._location_proxy.bind(),this.bind("location-changed",function(){i._checkLocation()}),this.bind("submit",function(n){if(!e.targetIsThisWindow(n))return!0;var r=i._checkFormSubmission(t(n.target).closest("form"));return r===!1?n.preventDefault():!1}),t(window).bind("unload",function(){i.unload()}),this.trigger("changed")},unload:function(){if(!this.isRunning())return!1;var e=this;return this.trigger("unload"),this._location_proxy.unbind(),this.$element().unbind("submit").removeClass(e.eventNamespace()),t.each(this.listeners.toHash(),function(n,i){t.each(i,function(t,i){e._unlisten(n,i)})}),this._running=!1,this},destroy:function(){return this.unload(),delete e.apps[this.element_selector],this},bindToAllEvents:function(e){var n=this;return t.each(this.APP_EVENTS,function(t,i){n.bind(i,e)}),t.each(this.listeners.keys(!0),function(i,r){-1==t.inArray(r,n.APP_EVENTS)&&n.bind(r,e)}),this},routablePath:function(t){return t.replace(r,"")},lookupRoute:function(t,e){var n,i,r=this,o=!1,s=0;if("undefined"!=typeof this.routes[t])for(n=this.routes[t].length;n>s;s++)if(i=this.routes[t][s],r.routablePath(e).match(i.path)){o=i;break}return o},runRoute:function(e,n,i,r){var o,s,a,u,l,p,d,h,f=this,g=this.lookupRoute(e,n);if(this.debug&&this.log("runRoute",[e,n].join(" ")),this.trigger("run-route",{verb:e,path:n,params:i}),"undefined"==typeof i&&(i={}),t.extend(i,this._parseQueryString(n)),g){this.trigger("route-found",{route:g}),null!==(d=g.path.exec(this.routablePath(n)))&&(d.shift(),t.each(d,function(t,e){g.param_names[t]?i[g.param_names[t]]=c(e):(i.splat||(i.splat=[]),i.splat.push(c(e)))})),o=new this.context_prototype(this,e,n,i,r),a=this.arounds.slice(0),u=this.befores.slice(0),p=[o],i.splat&&(p=p.concat(i.splat)),s=function(){for(var t,e,n;u.length>0;)if(l=u.shift(),f.contextMatchesOptions(o,l[0])&&(t=l[1].apply(o,[o]),t===!1))return!1;return f.last_route=g,o.trigger("event-context-before",{context:o}),"function"==typeof g.callback&&(g.callback=[g.callback]),g.callback&&g.callback.length&&(e=-1,n=function(){e++,g.callback[e]?t=g.callback[e].apply(o,p):f._onComplete&&f._onComplete(o)},p.push(n),n()),o.trigger("event-context-after",{context:o}),t},t.each(a.reverse(),function(t,e){var n=s;s=function(){return e.apply(o,[n])}});try{h=s()}catch(m){this.error(["500 Error",e,n].join(" "),m)}return h}return this.notFound(e,n)},contextMatchesOptions:function(e,n,i){var r=n;if(("string"==typeof r||u(r))&&(r={path:r}),"undefined"==typeof i&&(i=!0),t.isEmptyObject(r))return!0;if(a(r.path)){var o,s,c,l;for(o=[],s=0,l=r.path.length;l>s;s+=1)c=t.extend({},r,{path:r.path[s]}),o.push(this.contextMatchesOptions(e,c));var p=t.inArray(!0,o)>-1?!0:!1;return i?p:!p}if(r.only)return this.contextMatchesOptions(e,r.only,!0);if(r.except)return this.contextMatchesOptions(e,r.except,!1);var d=!0,h=!0;return r.path&&(u(r.path)||(r.path=new RegExp(r.path.toString()+"$")),d=r.path.test(e.path)),r.verb&&(h="string"==typeof r.verb?r.verb===e.verb:r.verb.indexOf(e.verb)>-1),i?h&&d:!(h&&d)},getLocation:function(){return this._location_proxy.getLocation()},setLocation:function(t){return this._location_proxy.setLocation(t)},swap:function(t,e){var n=this.$element().html(t);return s(e)&&e(t),n},templateCache:function(t,e){return"undefined"!=typeof e?h[t]=e:h[t]},clearTemplateCache:function(){return h={}},notFound:function(t,e){var n=this.error(["404 Not Found",t,e].join(" "));return"get"===t?n:!0},error:function(t,e){if(e||(e=new Error),e.message=[t,e.message].join(" "),this.trigger("error",{message:e.message,error:e}),this.raise_errors)throw e;this.log(e.message,e)},_checkLocation:function(){var t,e;return t=this.getLocation(),this.last_location&&"get"==this.last_location[0]&&this.last_location[1]==t||(this.last_location=["get",t],e=this.runRoute("get",t)),e},_getFormVerb:function(e){var n,i,r=t(e);return i=r.find('input[name="_method"]'),i.length>0&&(n=i.val()),n||(n=r[0].getAttribute("method")),n&&""!==n||(n="get"),t.trim(n.toString().toLowerCase())},_checkFormSubmission:function(e){var n,i,r,o,s;return this.trigger("check-form-submission",{form:e}),n=t(e),i=n.attr("action")||"",r=this._getFormVerb(n),this.debug&&this.log("_checkFormSubmission",n,i,r),"get"===r?(o=this._serializeFormParams(n),""!==o&&(i+="?"+o),this.setLocation(i),s=!1):(o=t.extend({},this._parseFormParams(n)),s=this.runRoute(r,i,o,e.get(0))),"undefined"==typeof s?!1:s},_serializeFormParams:function(t){var e,n="",i=t.serializeArray();if(i.length>0)for(n=this._encodeFormPair(i[0].name,i[0].value),e=1;e<i.length;e++)n=n+"&"+this._encodeFormPair(i[e].name,i[e].value);return n},_encodeFormPair:function(t,e){return l(t)+"="+l(e)},_parseFormParams:function(t){var e,n={},i=t.serializeArray();for(e=0;e<i.length;e++)n=this._parseParamPair(n,i[e].name,i[e].value);return n},_parseQueryString:function(t){var e,n,i,o,s={};if(e=t.match(r),e&&e[1])for(n=e[1].split("&"),o=0;o<n.length;o++)i=n[o].split("="),s=this._parseParamPair(s,c(i[0]),c(i[1]||""));return s},_parseParamPair:function(t,e,n){return"undefined"!=typeof t[e]?a(t[e])?t[e].push(n):t[e]=[t[e],n]:t[e]=n,t},_listen:function(t,e){return this.$element().bind([t,this.eventNamespace()].join("."),e)},_unlisten:function(t,e){return this.$element().unbind([t,this.eventNamespace()].join("."),e)}}),e.RenderContext=function(t){this.event_context=t,this.callbacks=[],this.previous_content=null,this.content=null,this.next_engine=!1,this.waiting=!1},e.RenderContext.prototype=t.extend({},e.Object.prototype,{then:function(t){if(!s(t)){if(!("string"==typeof t&&t in this.event_context))return this;var e=this.event_context[t];t=function(t){return e.apply(this.event_context,[t])}}var n=this;return this.waiting?this.callbacks.push(t):(this.wait(),window.setTimeout(function(){var e=t.apply(n,[n.content,n.previous_content]);e!==!1&&n.next(e)},0)),this},wait:function(){this.waiting=!0},next:function(t){this.waiting=!1,"undefined"!=typeof t&&(this.previous_content=this.content,this.content=t),this.callbacks.length>0&&this.then(this.callbacks.shift())},load:function(e,n,i){var r=this;return this.then(function(){var o,a,u;return s(n)?(i=n,n={}):n=t.extend({},n),i&&this.then(i),"string"==typeof e?(u=e.match(/\.json$/)||n.json,o=u?n.cache===!0:n.cache!==!1,r.next_engine=r.event_context.engineFor(e),delete n.cache,delete n.json,n.engine&&(r.next_engine=n.engine,delete n.engine),o&&(a=this.event_context.app.templateCache(e))?a:(this.wait(),t.ajax(t.extend({url:e,data:{},dataType:u?"json":"text",type:"get",success:function(t){o&&r.event_context.app.templateCache(e,t),r.next(t)}},n)),!1)):e.nodeType?e.innerHTML:e.selector?(r.next_engine=e.attr("data-engine"),n.clone===!1?e.remove()[0].innerHTML.toString():e[0].innerHTML.toString()):void 0})},loadPartials:function(t){var e;if(t){this.partials=this.partials||{};for(e in t)!function(e,n){e.load(t[n]).then(function(t){this.partials[n]=t})}(this,e)}return this},render:function(t,e,n,i){return s(t)&&!e?this.then(t):(s(e)?(i=n,n=e,e=null):n&&!s(n)&&(i=n,n=null),this.loadPartials(i).load(t).interpolate(e,t).then(n))},partial:function(t,e,n,i){return s(n)?this.render(t,e,i).swap(n):s(e)?this.render(t,{},n).swap(e):this.render(t,e,n).swap()},send:function(){var t=this,e=o(arguments),n=e.shift();return a(e[0])&&(e=e[0]),this.then(function(){return e.push(function(e){t.next(e)}),t.wait(),n.apply(n,e),!1})},collect:function(e,n,i){var r=this,o=function(){s(e)&&(n=e,e=this.content);var i=[],o=!1;return t.each(e,function(t,e){var s=n.apply(r,[t,e]);return s.jquery&&1==s.length&&(s=s[0],o=!0),i.push(s),s}),o?i:i.join("")};return i?o():this.then(o)},renderEach:function(e,n,i,r){return a(n)&&(r=i,i=n,n=null),this.load(e).then(function(o){var s=this;return i||(i=a(this.previous_content)?this.previous_content:[]),r?(t.each(i,function(t,i){var a={},u=this.next_engine||e;n?a[n]=i:a=i,r(i,s.event_context.interpolate(o,a,u))}),void 0):this.collect(i,function(t,i){var r={},s=this.next_engine||e;return n?r[n]=i:r=i,this.event_context.interpolate(o,r,s)},!0)})},interpolate:function(t,e,n){var i=this;return this.then(function(r,o){!t&&o&&(t=o),this.next_engine&&(e=this.next_engine,this.next_engine=!1);var s=i.event_context.interpolate(r,t,e,this.partials);return n?o+s:s})},swap:function(t){return this.then(function(e){return this.event_context.swap(e,t),e}).trigger("changed",{})},appendTo:function(e){return this.then(function(n){t(e).append(n)}).trigger("changed",{})},prependTo:function(e){return this.then(function(n){t(e).prepend(n)}).trigger("changed",{})},replace:function(e){return this.then(function(n){t(e).html(n)}).trigger("changed",{})},trigger:function(t,e){return this.then(function(n){return"undefined"==typeof e&&(e={content:n}),this.event_context.trigger(t,e),n})}}),e.EventContext=function(t,n,i,r,o){this.app=t,this.verb=n,this.path=i,this.params=new e.Object(r),this.target=o},e.EventContext.prototype=t.extend({},e.Object.prototype,{$element:function(){return this.app.$element(o(arguments).shift())},engineFor:function(t){var e,n=this;return s(t)?t:(t=(t||n.app.template_engine).toString(),(e=t.match(/\.([^\.\?\#]+)$/))&&(t=e[1]),t&&s(n[t])?n[t]:n.app.template_engine?this.engineFor(n.app.template_engine):function(t){return t})},interpolate:function(t,e,n,i){return this.engineFor(n).apply(this,[t,e,i])},render:function(t,n,i,r){return new e.RenderContext(this).render(t,n,i,r)},renderEach:function(t,n,i,r){return new e.RenderContext(this).renderEach(t,n,i,r)},load:function(t,n,i){return new e.RenderContext(this).load(t,n,i)},loadPartials:function(t){return new e.RenderContext(this).loadPartials(t)},partial:function(t,n,i,r){return new e.RenderContext(this).partial(t,n,i,r)},send:function(){var t=new e.RenderContext(this);return t.send.apply(t,arguments)},redirect:function(){var e,n=o(arguments),i=this.app.getLocation(),r=n.length;if(r>1){for(var s=0,a=[],u=[],c={},l=!1;r>s;s++)"string"==typeof n[s]?a.push(n[s]):(t.extend(c,n[s]),l=!0);if(e=a.join("/"),l){for(var p in c)u.push(this.app._encodeFormPair(p,c[p]));e+="?"+u.join("&")}}else e=n[0];this.trigger("redirect",{to:e}),this.app.last_location=[this.verb,this.path],this.app.setLocation(e),new RegExp(e).test(i)&&this.app.trigger("location-changed")},trigger:function(t,e){return"undefined"==typeof e&&(e={}),e.context||(e.context=this),this.app.trigger(t,e)},eventNamespace:function(){return this.app.eventNamespace()},swap:function(t,e){return this.app.swap(t,e)},notFound:function(){return this.app.notFound(this.verb,this.path)},json:function(e){return t.parseJSON(e)},toString:function(){return"Sammy.EventContext: "+[this.verb,this.path,this.params].join(" ")}}),e}),function(t){function e(t,e,n,i,r){this._listener=e,this._isOnce=n,this.context=i,this._signal=t,this._priority=r||0}function n(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function i(){this._bindings=[],this._prevParams=null}e.prototype={active:!0,params:null,execute:function(t){var e,n;return this.active&&this._listener&&(n=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,n),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},i.prototype={VERSION:"0.8.1",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,n,i,r){var o,s=this._indexOfListener(t,i);if(-1!==s){if(o=this._bindings[s],o.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else o=new e(this,t,n,i,r),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var n,i=this._bindings.length;i--;)if(n=this._bindings[i],n._listener===t&&n.context===e)return i;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){return n(t,"add"),this._registerListener(t,!1,e,i)},addOnce:function(t,e,i){return n(t,"addOnce"),this._registerListener(t,!0,e,i)},remove:function(t,e){n(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=e),n){t=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var r=i;r.Signal=i,"function"==typeof define&&define.amd?define("core/libs/signals",[],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:t.signals=r}(this),define("core/SignalsEmitter",["core/libs/signals"],function(t){function e(){this._signals={}}function n(t,e){if(!this.active)return e(),void 0;var n,i=this._bindings.length;if(this.memorize&&(this._prevParams=t),!i)return e(),void 0;n=this._bindings.slice(),this._shouldPropagate=!0;var r=this,o=function(o){return o?(e(o),void 0):(i--,n[i]&&r._shouldPropagate&&n[i].execute(t)!==!1?void 0:(e(),void 0))};t.push(o),o()}var i=e.prototype;return i.getSignal=function(e){return"undefined"==typeof this._signals[e]&&(this._signals[e]=new t.Signal),this._signals[e]},i.addListener=function(t,e,n){var i=this.getSignal(t).add(e,null,n);return this.emit("newListener",t,e,n),i},i.on=i.addListener,i.when=i.addListener,i.once=function(t,e,n){return this.getSignal(t).addOnce(e,null,n)},i.removeListener=function(t,e){return this.getSignal(t).remove(e,null),this.emit("removeListener",t,e),this},i.removeAllListeners=function(t){if("undefined"==typeof t)return this.getSignal(t).removeAll(),this;for(var e in this._signals)this._signals[e].removeAll();return this},i.emit=function(t){var e=this.getSignal(t),n=Array.prototype.slice.call(arguments,1);return e.dispatch.apply(e,n),this},i.trigger=function(t){var e=this.getSignal(t),i=Array.prototype.slice.call(arguments,1),r=i.pop();return n.call(e,i,r),this},e}),define("core/Registry",[],function(){function t(){this._data={}}var e=function(t,e){for(var n=e.split("."),i=null,r=null,o=0;o<n.length&&(r=t,i=n[o],"undefined"==typeof t[i]&&(t[i]={}),t=t[i],t);o++);return[t,r,i]};return t.prototype.get=function(t){var n=e(this._data,t)[0];return"object"==typeof n?Array.isArray(n)?n.slice():$.extend({},n):n},t.prototype.set=function(t,n){"undefined"==typeof n&&(n={});var i=e(this._data,t);return i[1][i[2]]=n,this},t.prototype.extend=function(t,n,i){"undefined"==typeof i&&(i=n,n=!1,"undefined"==typeof i&&(i={}));var r=e(this._data,t);return"undefined"==typeof r[1][r[2]]&&(r[1][r[2]]={}),$.extend(n||!1,r[1][r[2]],i),this},t.prototype.unset=function(t){var n=e(this._data,t);return delete n[1][n[2]],this},t.prototype.push=function(t,n,i){arguments.length<3&&(i=n,n=null);var r=e(this._data,t);return Array.isArray(r[0])||(r[0]=[],r[1][r[2]]=r[0]),null===n?r[0].push(i):r[0][n]=i,this},t}),define("core/libs/util",{inherits:function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}}),define("core/Widget",["core/libs/util","core/SignalsEmitter"],function(t,e){function n(t){n.super_.call(this),this._elm=null,this._parent=null,this._markAsLoaded=!1,this.options=$.extend({},this.defaults,t||{})}function i(e,n){e.prototype.defaults&&(e.prototype.defaults=$.extend(e.prototype.defaults,n.prototype.defaults,e.prototype.defaults)),t.inherits(e,n),e.extend=function(t){i(t,e)};for(var r in n)"undefined"==typeof e[r]&&(e[r]=n[r])}t.inherits(n,e);var r=n.prototype;return n.extend=function(t){i(t,n)},n.create=function(t,e){var i=t.__widget||e||n;return"string"==typeof i&&(i=n[i]||e||n),new i(t)},n.configElm=function(t,e){return e.id&&t.attr("id",e.id),e.className&&t.addClass(e.className),e.css&&t.css(e.css),e.attr&&t.attr(e.attr),e.prop&&t.attr(e.prop),e.bind&&t.bind(e.bind),t},r.defaults={},r.create=function(t,e){return t instanceof n&&(e=t,t=e._elm),this._parent=e||null,this._elm=this._create(t,e),t&&this._elm.appendTo(t),this._elm.data("widget",this),this._elm},r.destroy=function(){return this._destroy(),this._elm.remove(),this._elm=null,this._parent=null,this},r.reload=function(){return this._markAsLoaded=!1,this.load.apply(this,arguments)},r.load=function(t,e){if("boolean"!=typeof t&&(e=t,t=!1),e||(e=function(t){if(t)throw t}),this._markAsLoaded)return t||this.render(),e(),void 0;var n=this;this._load(function(i){return i?e(i):(n.trigger("load",function(i){return i?e(i):(n._markAsLoaded=!0,t||n.render(),e(),void 0)}),void 0)})},r.element=function(){return this._elm},r.render=function(t){return t=$.extend(this.options,t||{}),this._render(t),this.emit("render",t),this},r._load=function(t){t(new Error("Not implemented"))},r._create=function(t,e,i){return i||(i=$('<div class="widget" />')),n.configElm(i,this.options),i},r._destroy=function(){},r._render=function(){},n}),define("core/dcms-ajax",["jquery","core/libs/sammy","core/SignalsEmitter","core/Registry","core/Widget"],function(t,e,n,i,r){function o(t){s(function(e){return e?t(e):(a(t),void 0)})}function s(e){var n=u.registry.get("plugins"),i=[],r=[];t.each(n,function(t,e){e._path!==!1&&(i.push(e._path||"plugins/"+t),r.push(t))}),requirejs(i,function(){var i=arguments;t.each(r,function(t,e){u.plugins[e]=i[t]});try{t.each(n,function(t,e){e&&u.plugins[t]&&u.plugins[t](u,e)})}catch(o){return e(o)}e(null)},e)}function a(e){var n=[];t.each(u.registry.get("modules"),function(t,e){n.push("modules/"+e)}),requirejs(n,function(){e(null)},e)}var u=window.DA=new n;return u.Widget=r,u.plugins={},u.registry=new i,u.registry.set("plugins",{}),u.registry.set("modules",[]),u.app=e(),u.setLocation=function(t,e){return e||(u.app.trigger("redirect",{to:t}),u.app.last_location=["get",t]),u.app.setLocation(t),this},u.api=function(e){return e=t.extend({type:"GET",dataType:"json",success:t.noop,error:t.noop},e),t.ajax(t.extend({},e,{success:function(t,n,i){return t&&"number"==typeof t.status?"undefined"==typeof t.data?(console&&console.error&&console.error("Api Error: "+t.status+" "+(t.msg||n)),e.error(t.status||-1,t.msg||n,i)):e.success(t.data,t.status,t.msg,i):(console&&console.error&&console.error("Api Error: Invalid format"),e.error(-1,t&&t.msg||n,i))},error:function(t,n,i){return e.error(n||-1,null,{jqXHR:t,errorThrown:i})}}))},u.bootstrap=function(){o(function(e){if(e)throw e;u.trigger("initiated",function(e){if(e)throw e;t(function(){u.app.after(function(){u.emit("app.after")}),u.app.get("#/",function(){u.trigger("index",function(t){if(t)throw t})}),u.trigger("runned",function(t){if(t)throw t;u.app.run("#/")})})})})},u.require=function(t,e){requirejs([t],function(){e(null)},e)},u}),define("core/widgets/Nav",["core/dcms-ajax"],function(t){function e(){e.super_.apply(this,arguments)}t.Widget.extend(e);var n=e.prototype;return e.renderItems=function(t,n){for(var i in t)e.renderItem(t[i],n)},e.renderItem=function(n,i){var r=e._createItem(n,i);if(n.items){r.addClass("dropdown"),r.children("a:first").addClass("dropdown-toggle").attr("data-toggle","dropdown").append(' <b class="caret" />');var i=$('<ul class="dropdown-menu" />').appendTo(r);t.Widget.Dropdown?t.Widget.Dropdown.renderItems(n.items,i):e.renderItems(n.items,i)}return r},n.defaults={items:[]},e._createItem=function(e,n){var i=t.Widget.configElm($("<li />"),e).appendTo(n),r=$("<a />").appendTo(i).attr("tabindex",e.tabindex||-1).attr("href",e.url||"#").text(e.label||e);if(e.toggle&&r.attr("data-toggle",e.toggle),e.icon&&(r.prepend(" "),$("<i />").prependTo(r).addClass(e.icon.className||e.icon)),e.closeIcon){r.append(" ");var o=$('<i class="close" />').appendTo(r).addClass(e.closeIcon.className||"close").append(e.closeIcon.html||"&times;");e.closeIcon.click&&o.click(function(t){e.closeIcon.useDefault||t.preventDefault(),e.closeIcon.click(t)})}return e.active&&i.addClass("active"),e.disabled&&i.addClass("disabled"),e.click&&r.click(function(t){e.useDefault||t.preventDefault(),e.click(t)}),e.dblclick&&r.dblclick(function(t){e.useDefault||t.preventDefault(),e.dblclick(t)}),i},n._create=function(t,n,i){return i||(i=$('<ul class="nav" />')),e.super_.prototype._create.call(this,t,n,i)},n._render=function(t){this._elm.empty(),e.renderItems(t.items,this._elm)},e}),define("core/widgets/NavBar",["core/dcms-ajax","core/widgets/Nav"],function(t,e){function n(){n.super_.apply(this,arguments)}t.Widget.extend(n);var i=n.prototype;return i._create=function(t,i,r){return r||(r=$('<div class="navbar" />')),r=n.super_.prototype._create.call(this,t,i,r),this._inner=$('<div class="navbar-inner" />').appendTo(r),this.nav=new e(this.options),this.nav.create(this._inner,this),r},i._destroy=function(){this.nav.destroy(),this.nav=null},i._render=function(t){var e=this;if(this._inner.children("a.brand").remove(),t.brand){var n=$('<a class="brand" />').attr("href",t.brand.url||"#/").prependTo(this._inner).text(t.brand);t.brand.click&&n.click(function(t){t.preventDefault(),e.options.brand.click(t)})}this.nav.render(t)},n}),function(){function t(t){var n=!1;return function(){if(n)throw new Error("Callback was already called.");n=!0,t.apply(e,arguments)}}var e,n,i={};e=this,null!=e&&(n=e.async),i.noConflict=function(){return e.async=n,i};var r=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n+=1)e(t[n],n,t)},o=function(t,e){if(t.map)return t.map(e);var n=[];return r(t,function(t,i,r){n.push(e(t,i,r))}),n},s=function(t,e,n){return t.reduce?t.reduce(e,n):(r(t,function(t,i,r){n=e(n,t,i,r)}),n)},a=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};"undefined"!=typeof process&&process.nextTick?(i.nextTick=process.nextTick,i.setImmediate="undefined"!=typeof setImmediate?setImmediate:i.nextTick):"function"==typeof setImmediate?(i.setImmediate=setImmediate,i.nextTick=setImmediate):(i.setImmediate=i.nextTick,i.nextTick=function(t){setTimeout(t,0)}),i.each=function(e,n,i){if(i=i||function(){},!e.length)return i();var o=0;r(e,function(r){n(r,t(function(t){t?(i(t),i=function(){}):(o+=1,o>=e.length&&i(null))}))})},i.forEach=i.each,i.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var i=0,r=function(){e(t[i],function(e){e?(n(e),n=function(){}):(i+=1,i>=t.length?n(null):r())})};r()},i.forEachSeries=i.eachSeries,i.eachLimit=function(t,e,n,i){var r=u(e);r.apply(null,[t,n,i])},i.forEachLimit=i.eachLimit;var u=function(t){return function(e,n,i){if(i=i||function(){},!e.length||0>=t)return i();var r=0,o=0,s=0;!function a(){if(r>=e.length)return i();for(;t>s&&o<e.length;)o+=1,s+=1,n(e[o-1],function(t){t?(i(t),i=function(){}):(r+=1,s-=1,r>=e.length?i():a())
})}()}},c=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[i.each].concat(e))}},l=function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[u(t)].concat(n))}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[i.eachSeries].concat(e))}},d=function(t,e,n,i){var r=[];e=o(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n,i){r[t.index]=i,e(n)})},function(t){i(t,r)})};i.map=c(d),i.mapSeries=p(d),i.mapLimit=function(t,e,n,i){return h(e)(t,n,i)};var h=function(t){return l(t,d)};i.reduce=function(t,e,n,r){i.eachSeries(t,function(t,i){n(e,t,function(t,n){e=n,i(t)})},function(t){r(t,e)})},i.inject=i.reduce,i.foldl=i.reduce,i.reduceRight=function(t,e,n,r){var s=o(t,function(t){return t}).reverse();i.reduce(s,e,n,r)},i.foldr=i.reduceRight;var f=function(t,e,n,i){var r=[];e=o(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n&&r.push(t),e()})},function(){i(o(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};i.filter=c(f),i.filterSeries=p(f),i.select=i.filter,i.selectSeries=i.filterSeries;var g=function(t,e,n,i){var r=[];e=o(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){n(t.value,function(n){n||r.push(t),e()})},function(){i(o(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};i.reject=c(g),i.rejectSeries=p(g);var m=function(t,e,n,i){t(e,function(t,e){n(t,function(n){n?(i(t),i=function(){}):e()})},function(){i()})};i.detect=c(m),i.detectSeries=p(m),i.some=function(t,e,n){i.each(t,function(t,i){e(t,function(t){t&&(n(!0),n=function(){}),i()})},function(){n(!1)})},i.any=i.some,i.every=function(t,e,n){i.each(t,function(t,i){e(t,function(t){t||(n(!1),n=function(){}),i()})},function(){n(!0)})},i.all=i.every,i.sortBy=function(t,e,n){i.map(t,function(t,n){e(t,function(e,i){e?n(e):n(null,{value:t,criteria:i})})},function(t,e){if(t)return n(t);var i=function(t,e){var n=t.criteria,i=e.criteria;return i>n?-1:n>i?1:0};n(null,o(e.sort(i),function(t){return t.value}))})},i.auto=function(t,e){e=e||function(){};var n=a(t);if(!n.length)return e(null);var o={},u=[],c=function(t){u.unshift(t)},l=function(t){for(var e=0;e<u.length;e+=1)if(u[e]===t)return u.splice(e,1),void 0},p=function(){r(u.slice(0),function(t){t()})};c(function(){a(o).length===n.length&&(e(null,o),e=function(){})}),r(n,function(n){var u=t[n]instanceof Function?[t[n]]:t[n],d=function(t){var s=Array.prototype.slice.call(arguments,1);if(s.length<=1&&(s=s[0]),t){var u={};r(a(o),function(t){u[t]=o[t]}),u[n]=s,e(t,u),e=function(){}}else o[n]=s,i.setImmediate(p)},h=u.slice(0,Math.abs(u.length-1))||[],f=function(){return s(h,function(t,e){return t&&o.hasOwnProperty(e)},!0)&&!o.hasOwnProperty(n)};if(f())u[u.length-1](d,o);else{var g=function(){f()&&(l(g),u[u.length-1](d,o))};c(g)}})},i.waterfall=function(t,e){if(e=e||function(){},t.constructor!==Array){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();var r=function(t){return function(n){if(n)e.apply(null,arguments),e=function(){};else{var o=Array.prototype.slice.call(arguments,1),s=t.next();s?o.push(r(s)):o.push(e),i.setImmediate(function(){t.apply(null,o)})}}};r(i.iterator(t))()};var v=function(t,e,n){if(n=n||function(){},e.constructor===Array)t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var i={};t.each(a(e),function(t,n){e[t](function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[t]=r,n(e)})},function(t){n(t,i)})}};i.parallel=function(t,e){v({map:i.map,each:i.each},t,e)},i.parallelLimit=function(t,e,n){v({map:h(e),each:u(e)},t,n)},i.series=function(t,e){if(e=e||function(){},t.constructor===Array)i.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};i.eachSeries(a(t),function(e,i){t[e](function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),n[e]=r,i(t)})},function(t){e(t,n)})}},i.iterator=function(t){var e=function(n){var i=function(){return t.length&&t[n].apply(null,arguments),i.next()};return i.next=function(){return n<t.length-1?e(n+1):null},i};return e(0)},i.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var y=function(t,e,n,i){var r=[];t(e,function(t,e){n(t,function(t,n){r=r.concat(n||[]),e(t)})},function(t){i(t,r)})};i.concat=c(y),i.concatSeries=p(y),i.whilst=function(t,e,n){t()?e(function(r){return r?n(r):(i.whilst(t,e,n),void 0)}):n()},i.doWhilst=function(t,e,n){t(function(r){return r?n(r):(e()?i.doWhilst(t,e,n):n(),void 0)})},i.until=function(t,e,n){t()?n():e(function(r){return r?n(r):(i.until(t,e,n),void 0)})},i.doUntil=function(t,e,n){t(function(r){return r?n(r):(e()?n():i.doUntil(t,e,n),void 0)})},i.queue=function(e,n){function o(t,e,o,s){e.constructor!==Array&&(e=[e]),r(e,function(e){var r={data:e,callback:"function"==typeof s?s:null};o?t.tasks.unshift(r):t.tasks.push(r),t.saturated&&t.tasks.length===n&&t.saturated(),i.setImmediate(t.process)})}void 0===n&&(n=1);var s=0,a={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(t,e){o(a,t,!1,e)},unshift:function(t,e){o(a,t,!0,e)},process:function(){if(s<a.concurrency&&a.tasks.length){var n=a.tasks.shift();a.empty&&0===a.tasks.length&&a.empty(),s+=1;var i=function(){s-=1,n.callback&&n.callback.apply(n,arguments),a.drain&&0===a.tasks.length+s&&a.drain(),a.process()},r=t(i);e(n.data,r)}},length:function(){return a.tasks.length},running:function(){return s}};return a},i.cargo=function(t,e){var n=!1,s=[],a={tasks:s,payload:e,saturated:null,empty:null,drain:null,push:function(t,n){t.constructor!==Array&&(t=[t]),r(t,function(t){s.push({data:t,callback:"function"==typeof n?n:null}),a.saturated&&s.length===e&&a.saturated()}),i.setImmediate(a.process)},process:function u(){if(!n){if(0===s.length)return a.drain&&a.drain(),void 0;var i="number"==typeof e?s.splice(0,e):s.splice(0),c=o(i,function(t){return t.data});a.empty&&a.empty(),n=!0,t(c,function(){n=!1;var t=arguments;r(i,function(e){e.callback&&e.callback.apply(null,t)}),u()})}},length:function(){return s.length},running:function(){return n}};return a};var _=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&r(n,function(e){console[t](e)}))}]))}};i.log=_("log"),i.dir=_("dir"),i.memoize=function(t,e){var n={},i={};e=e||function(t){return t};var r=function(){var r=Array.prototype.slice.call(arguments),o=r.pop(),s=e.apply(null,r);s in n?o.apply(null,n[s]):s in i?i[s].push(o):(i[s]=[o],t.apply(null,r.concat([function(){n[s]=arguments;var t=i[s];delete i[s];for(var e=0,r=t.length;r>e;e++)t[e].apply(null,arguments)}])))};return r.memo=n,r.unmemoized=t,r},i.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},i.times=function(t,e,n){for(var r=[],o=0;t>o;o++)r.push(o);return i.map(r,e,n)},i.timesSeries=function(t,e,n){for(var r=[],o=0;t>o;o++)r.push(o);return i.mapSeries(r,e,n)},i.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var e=this,n=Array.prototype.slice.call(arguments),r=n.pop();i.reduce(t,n,function(t,n,i){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);i(t,e)}]))},function(t,n){r.apply(e,[t].concat(n))})}};var b=function(t,e){var n=function(){var n=this,i=Array.prototype.slice.call(arguments),r=i.pop();return t(e,function(t,e){t.apply(n,i.concat([e]))},r)};if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return n.apply(this,i)}return n};i.applyEach=c(b),i.applyEachSeries=p(b),i.forever=function(t,e){function n(i){if(i){if(e)return e(i);throw i}t(n)}n()},"undefined"!=typeof define&&define.amd?define("core/libs/async",[],function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:e.async=i}(),define("core/widgets/Container",["core/dcms-ajax","core/libs/async"],function(t,e){function n(){n.super_.apply(this,arguments),this._children=[]}t.Widget.extend(n);var i=n.prototype;return i.defaults={children:[]},i.create=function(){var t=n.super_.prototype.create.apply(this,arguments);this._container||(this._container=t);for(var e in this.options.children)this.insert(this.options.children[e]);return this.options.children=[],t},i.insert=function(e){return e instanceof t.Widget||(e=t.Widget.create(e)),e.create(this._container,this),this._children.push(e),this.emit("inserted",e),e},i.eachChild=function(t){for(var e in this._children)t(this._children[e],e);return this},i.remove=function(t,e){var n=this._children.indexOf(t);if(-1===n)throw new Error("The given widget isn't child of this widget");return this._children.splice(n,1),e||t.destroy(),this.emit("removed",t,e),this},i._load=function(t){var n=[];this.eachChild(function(t){n.push(function(e){t.load(!0,e)})}),e.series(n,t)},i._render=function(){this.eachChild(function(t){t.render()})},i._destroy=function(){this.eachChild(function(t){t.destroy()})},n}),define("core/widgets/Tab",["core/dcms-ajax"],function(t){function e(){e.super_.apply(this,arguments),this.options.id||(this.options.id="tab-"+ ++n),null!==this.options.location&&(this.options.location=t.app.getLocation())}var n=0;t.Widget.extend(e);var i=e.prototype;return e.create=function(t){return"string"==typeof t&&(t={label:t}),new e(t)},i.defaults={label:"Tab",active:!0,hideCloseIcon:!1},i.label=function(t){return"undefined"==typeof t?this.options.label:(this.options.label=t,this._parent&&this._parent.renderNav(),this)},i.active=function(e,n){return"undefined"==typeof e?this.options.active||!1:(this.options.active=e,e&&this.options.location&&t.setLocation(this.options.location),!this._elm||n?this:(e?this._elm.addClass("active"):this._elm.removeClass("active"),this))},i._create=function(t,n,i){return i||(i=$('<div class="tab-pane" />')),e.super_.prototype._create.call(this,t,n,i)},i._load=function(t){t(null)},i._render=function(t){this.active(t.active)},e}),define("core/widgets/Tabs",["core/dcms-ajax","core/libs/async","core/widgets/Container","core/widgets/Nav","core/widgets/Tab"],function(t,e,n,i,r){function o(){o.super_.apply(this,arguments)}n.extend(o);var s=o.prototype;return s.defaults={navClass:"nav-tabs",labelMaxLength:30,closeIcon:!1},s.insert=function(t){return t instanceof r||(t=r.create(t)),t.options.active&&this.setActive(t),t=o.super_.prototype.insert.call(this,t),this._renderNav(),t},s.remove=function(e){return o.super_.prototype.remove.apply(this,arguments),this._children.length>0?this.setActive(this._children[0]):e.options.location&&t.setLocation("#/"),this._renderNav(),this},s.setActive=function(t,e){return this.eachChild(function(t){t.active(!1,e)}),t.active(!0,e),this},s.renderNav=function(){return this._renderNav(),this},s._create=function(t,e,n){n||(n=$('<div class="tabbable" />')),this.nav=new i(this._getNavOptions(this.options));var r=this,s=this.nav.create(n,this);return s.on("shown",'a[data-toggle="tab"]',function(t){var e=$(t.target).parent().prevAll().length;r._children[e]&&r.setActive(r._children[e],!0)}),this._container=$('<div class="tab-content" />').appendTo(n),n=o.super_.prototype._create.call(this,t,e,n)},s._destroy=function(){this.nav.destroy(),this.nav=null,o.super_.prototype._destroy.apply(this,arguments)},s._getNavOptions=function(t){var e=this,n=[];return this.eachChild(function(t){var i=$.extend({},t.options),r=e.options.labelMaxLength;i.id=null,i.url="#"+t.options.id,i.toggle="tab",e.options.closeIcon&&!t.options.hideCloseIcon&&(i.dblclick=function(){e.remove(t)},i.closeIcon={click:i.dblclick}),i.label&&i.label.length>r&&(i.attr||(i.attr={}),i.attr.title=i.label,i.label=i.label.substr(0,r-1)+"â€¦"),n.push(i)}),$.extend(t.nav||{},{items:n,className:t.navClass})},s._load=function(t){var n=[];this.eachChild(function(t){n.push(function(e){t.load(!0,e)})}),e.parallel(n,t)},s._render=function(t){o.super_.prototype._render.apply(this,arguments),this._renderNav(t)},s._renderNav=function(t){this.nav.render(this._getNavOptions(t||this.options))},o}),define("core/plugins/layout",["core/widgets/NavBar","core/widgets/Tabs"],function(t,e){return function(n){n.registry.set("layout.menus.main",[]),n.layout={navbar:new t({id:"navbar",className:"navbar-fixed-top"})},n.tabs=new e({id:"tabs",closeIcon:!0});var i=n.layout.navbar.create("body").hide();n.tabs.create("body"),n.when("runned",function(t){n.layout.navbar.render({brand:n.registry.get("layout.brand"),items:n.registry.get("layout.menus.main")}),i.slideDown(),n.tabs.load(),t()})}}),define("core/widgets/Toolbar",["core/dcms-ajax","core/widgets/Container"],function(t,e){function n(){n.super_.apply(this,arguments),this._controls={}}e.extend(n);var i=n.prototype;return i._create=function(t,e,i){return i||(i=$('<div class="btn-toolbar" />')),n.super_.prototype._create.call(this,t,e,i)},n}),define("core/widgets/Button",["core/dcms-ajax"],function(t){function e(){e.super_.apply(this,arguments)}t.Widget.extend(e);var n=e.prototype;return n.defaults={type:null,url:null,label:null,click:null,toggle:null},e.create=function(t,e){var n=t.type||(t.url?"link":"button");return e="link"===n?$('<a class="btn" />').attr("href",t.url||"#"):"span"===n||"div"===n?$("<"+n+' class="btn" />'):$('<button class="btn" />').attr("type",t.type||"button"),t.id&&e.attr("id",t.id),t.className&&e.addClass(t.className),e.text(t.label),t.icon&&(e.prepend(" "),$("<i />").prependTo(e).addClass(t.icon.className||t.icon)),t.toggle&&e.attr("data-toggle",t.toggle),t.click&&e.click(function(e){return t.useDefault||e.preventDefault(),t.click.apply(this,arguments)}),e},n._create=function(t,n,i){return i||(i=e.create(this.options)),e.super_.prototype._create.call(this,t,n,i)},e}),define("core/widgets/Dropdown",["core/dcms-ajax","core/widgets/Nav"],function(t,e){function n(){n.super_.apply(this,arguments)}e.extend(n);var i=n.prototype;return n.renderItems=function(t,e){for(var i in t)n.renderItem(t[i],e)},n.renderItem=function(t,e){var i=n._createItem(t,e);if(t.items){i.addClass("dropdown-submenu");var r=$('<ul class="dropdown-menu" />').appendTo(i);n.renderItems(t.items,r)}return i},n._createItem=function(e,i){if(e.divider){var r=t.Widget.configElm($("<li />"),e).appendTo(i);if(e.divider)return r.addClass("divider"),r}return n.super_._createItem.apply(n.super_,arguments)},i._create=function(t,e,i){return i||(i=$('<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel" />')),n.super_.prototype._create.call(this,t,e,i)},i._render=function(t){this._elm.empty(),n.renderItems(t.items,this._elm)},n}),define("core/widgets/ButtonGroup",["core/dcms-ajax","core/widgets/Button","core/widgets/Dropdown"],function(t,e,n){function i(){i.super_.apply(this,arguments)}t.Widget.extend(i);var r=i.prototype;return r.defaults={buttons:null,action:null,actions:null},r._create=function(t,r,o){return o||(o=$('<div class="btn-group" />')),o=i.super_.prototype._create.call(this,t,r,o),this.options.action&&(this._button=new e(this.options.action),this._button.create(o,this)),this.options.actions&&(this._dropdown=new n(this.options.actions),this._dropdown.create(o,this)),o},r._destroy=function(){this._button&&(this._button.destroy(),this._button=null),this._dropdown&&(this._dropdown.destroy(),this._dropdown=null)},r._render=function(t){if(t.buttons){this._elm.empty();for(var n in t.buttons)this._elm.append(e.create(t.buttons[n]))}t.action&&this._button.render(t.action),t.actions?(t.action?$('<button class="btn dropdown-toggle" data-toggle="dropdown" type="button" />').append('<span class="caret" />').insertAfter(this._button._elm):$('<button class="btn dropdown-toggle" data-toggle="dropdown" type="button" />').text(t.actionsLabel||t.label).append(' <span class="caret" />').insertAfter(this._button._elm),this._dropdown.render({items:t.actions})):this._elm.children(".btn.dropdown-toggle").remove()},i}),define("core/widgets/ProgressBar",["core/dcms-ajax"],function(t){function e(){e.super_.apply(this,arguments)}t.Widget.extend(e);var n=e.prototype;return e.createBar=function(t){var e="number"==typeof t.percentage?t.percentage:t,n=$('<div class="bar" />').css("width",100*e+"%");return t.barClass&&n.addClass(t.barClass),n},n.defaults={className:"progress-striped",barClass:"",percentage:.6,bars:[]},n._create=function(t,n,i){return i||(i=$('<div class="progress" />')),i=e.super_.prototype._create.call(this,t,n,i)},n._render=function(t){this._elm.empty().removeClass("progress-striped active"),$.each(t.bars,function(t,n){e.createBar(n).appendTo(this._elm)}),e.createBar(t).appendTo(this._elm)},e}),function(){function t(t,e,n,i,r,o){e[t]&&(n.push(t),(e[t]===!0||1===e[t])&&i.push(r+t+"/"+o))}function e(t,e,n,i,r){var o=i+e+"/"+r;require._fileExists(t.toUrl(o+".js"))&&n.push(o)}function n(t,e,i){var r;for(r in e)!e.hasOwnProperty(r)||t.hasOwnProperty(r)&&!i?"object"==typeof e[r]&&n(t[r],e[r],i):t[r]=e[r]}var i=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(r){var o=r.config?r.config():{};return{version:"2.0.1+",load:function(r,s,a,u){u=u||{},u.locale&&(o.locale=u.locale);var c,l,p,d=i.exec(r),h=d[1],f=d[4],g=d[5],m=f.split("-"),v=[],y={},_="";if(d[5]?(h=d[1],c=h+g):(c=r,g=d[4],f=o.locale,f||(f=o.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),m=f.split("-")),u.isBuild){for(v.push(c),e(s,"root",v,h,g),l=0;l<m.length;l++)p=m[l],_+=(_?"-":"")+p,e(s,_,v,h,g);s(v,function(){a()})}else s([c],function(e){var i,r=[];for(t("root",e,r,v,h,g),l=0;l<m.length;l++)i=m[l],_+=(_?"-":"")+i,t(_,e,r,v,h,g);s(v,function(){var t,i,o;for(t=r.length-1;t>-1&&r[t];t--)o=r[t],i=e[o],(i===!0||1===i)&&(i=s(h+o+"/"+g)),n(y,i);a(y)})})}}})}(),define("core/nls/widgets",{root:{Table:{Yes:"Yes",No:"No"},FormActions:{Save:"Save changes",Cancel:"Cancel"},Pagination:{previousArrow:"Â«",nextArrow:"Â»"},InputFile:{selectFile:"Select file...",selectFiles:"Select files...",del:"Delete"}},"he-iw":!0}),define("core/nls/index",["i18n!core/nls/widgets"],function(t){return{widgets:t}}),define("core/widgets/Table",["core/dcms-ajax","core/nls/index"],function(t,e){function n(){n.super_.apply(this,arguments)}e=e.widgets.Table,t.Widget.extend(n);var i=n.prototype;return i.defaults={className:"table-hover",sort:!1,columns:null,idField:"_id",rows:[]},i.eachColumn=function(t,e){var n=this;$.each(t,function(t,i){i=n._defineColumn(i,t),e(i,t)})},i.isSorted=function(t){return"undefined"==typeof t?this.options.sort?!0:!1:this.options.sort&&this.options.sort[t]||0},i.sort=function(t,e){return this.emit("sort",t,e),this},i.unsort=function(t){return this.emit("unsort",t),this},i._create=function(t,e,i){return i||(i=$('<table class="table" />')),n.super_.prototype._create.call(this,t,e,i)},i._defineColumn=function(t,e){if("string"==typeof t&&(t={label:t}),t.name||(t.name=e),t.type){var n=t.type.charAt(0).toUpperCase()+t.type.slice(1),i="_defineColumn"+n,r="_render"+n;"function"==typeof this[i]&&(t=this[i](t,e)),t.render||"function"!=typeof this[r]||(t.render=this[r])}return t},i._render=function(t){var e,n=this;this._elm.empty(),t.columns&&(this._thead=$("<thead />").appendTo(this._elm),e=$("<tr />").appendTo(this._thead),this.eachColumn(t.columns,function(t){n._columnLabelRender(t).appendTo(e).attr("data-name",t.name)})),this._tbody=$("<tbody />").appendTo(this._elm);for(var i in t.rows)!function(e){var r=e[t.idField]||i,o=$("<tr />").appendTo(n._tbody).attr("data-id",r);if(t.columns)n.eachColumn(t.columns,function(t){var n=e[t.name],i=$("<td />").appendTo(o);"function"==typeof t.render?t.render(i,n,e):i.text(n)});else for(var s in e)$("<td />").appendTo(o).text(e[s])}(t.rows[i])},i._columnLabelRender=function(t){if(!t.label)return $("<td />");var e=this,n=$("<th />"),i=t.name,r=this.isSorted(i);return this.options.sort&&!t.disableSort?(r&&$("<i />").appendTo(n).addClass(r>0?"icon-arrow-up":"icon-arrow-down"),$('<a href="#" />').appendTo(n).text(t.label).click(function(t){t.preventDefault(),r?r>0?e.sort(i,-1):e.unsort(i):e.sort(i,1)})):n.text(t.label),n},i._defineColumnBoolean=function(t){return t=$.extend({trueLabel:e.Yes,falseLabel:e.No,trueClass:"text-success",falseClass:"text-error"},t)},i._renderBoolean=function(t,e){e?(t.text(this.trueLabel),this.trueClass&&t.addClass(this.trueClass),this.trueClass&&t.addClass(this.trueClass)):(t.text(this.trueLabel),this.falseClass&&t.addClass(this.falseClass))},i._renderWidget=function(e,n,i){var r=this.instance,o=this.options||{};if("function"==typeof o&&(o=o(i,n)),r)r.create(e),r.render(o);else{if(r=this.widget,"string"==typeof r&&(r=t.Widget[r]),!r)throw new Error("Invalid widget: "+this.widget);r=this.instance=new r(o),r.create(e),r.render()}},n}),define("core/widgets/Pagination",["core/dcms-ajax","core/nls/index"],function(t,e){function n(){n.super_.apply(this,arguments)}e=e.widgets.Pagination,t.Widget.extend(n);var i=n.prototype;return i.defaults={pages:null,current:1,displayLimit:5,hidePrevious:!1,hideNext:!1,previousLabel:e.previousArrow,nextLabel:e.nextArrow},i.current=function(t){return"undefined"==typeof t?this.options.current:(t>=1&&t<=this.options.pages&&(this.render({current:t}),this.emit("change",t)),this)},i.next=function(){return this.hasNext()&&this.current(this.options.current+1),this.options.current},i.prev=function(){return this.hasPrev()&&this.current(this.options.current-1),this.options.current},i.hasNext=function(){return this.options.current<this.options.pages},i.hasPrev=function(){return this.options.current>1},i._create=function(t,e,i){return i||(i=$('<div class="pagination" />')),i=n.super_.prototype._create.call(this,t,e,i),i.hide(),i},i._render=function(t){if(this._elm.empty().show(),!t.pages)return this._elm.hide(),void 0;var e=$("<ul />").appendTo(this._elm);t.hidePrevious||this._renderPrev(e,t);var n=this,i=Math.max(1,this.current()-Math.floor(t.displayLimit/2));i+t.displayLimit>t.pages&&(i=Math.max(1,t.pages-t.displayLimit));for(var r=0;r<t.displayLimit&&i<=t.pages;r++)!function(t){n._renderPage(e,t.toString(),t!==n.current()?function(){n.current(t)}:"active")}(i++);t.hideNext||this._renderNext(e,t)},i._renderPrev=function(t,e){var n=this;this._renderPage(t,e.previousLabel,this.hasPrev()?function(){n.prev()}:"disabled")},i._renderNext=function(t,e){var n=this;this._renderPage(t,e.nextLabel,this.hasNext()?function(){n.next()}:"disabled")},i._renderPage=function(t,e,n){var i,r=$("<li />").appendTo(t);"function"==typeof n?i=$('<a href="#" />').click(function(t){t.preventDefault(),n(t)}):(r.addClass(n),i=$("<span />")),i.appendTo(r).text(e)},n}),define("core/widgets/Browser",["core/dcms-ajax","core/widgets/Table","core/widgets/Pagination"],function(t,e,n){function i(){i.super_.apply(this,arguments)}t.Widget.extend(i);var r=i.prototype;return r.defaults={api:null,limit:20,offset:0,count:null,fields:{},entities:[],sort:[],tableClass:"table-hover table-condensed",paginationClass:"pagination-centered"},r._create=function(t,r,o){o||(o=$('<div class="browser" />')),o=i.super_.prototype._create.call(this,t,r,o);var s=this;return this.table=new e(this._getTableOptions(this.options)),this.table.create(o,this),this.table.when("sort",function(t,e){s.options.sort[t]||(s.options.sort={}),s.options.sort[t]=e,s.reload()}),this.table.when("unsort",function(t){delete s.options.sort[t],s.reload()}),this.pagination=new n(this._getPaginationOptions(this.options)),this.pagination.create(o,this),this.pagination.on("change",function(t){s.options.offset=(t-1)*s.options.limit,s.reload()}),o},r._getTableOptions=function(t){return $.extend(t.table||{},{sort:t.sort,className:t.tableClass,columns:t.fields,rows:t.entities})},r._getPaginationOptions=function(t){return $.extend(t.pagination||{},{className:t.paginationClass,pages:t.count&&t.limit?Math.ceil(t.count/t.limit):null,current:t.limit?1+Math.ceil(t.offset/t.limit):1})},r._load=function(e){if(!this.options.api)return e(null),void 0;var n=this,i={data:{limit:this.options.limit,offset:this.options.offset,sort:this.options.sort}};"string"==typeof this.options.api?i.url=this.options.api:$.extend(!0,i,this.options.api),i.success=function(t){$.extend(n.options,t),e(null)},i.error=e,t.api(i)},r._render=function(t){this.table.render(this._getTableOptions(t)),this.pagination.render(this._getPaginationOptions(t))},i}),define("core/widgets/Control",["core/dcms-ajax"],function(t){function e(){e.super_.apply(this,arguments),"undefined"==typeof this.options.id&&(this.options.id=this.options.name)}t.Widget.extend(e);var n=e.prototype;return e.types={},e.create=function(n){return t.Widget.create(n,e.types[n.type]||e.types.default)},e.escape=function(t){return $("<span />").text(t).html()},n.defaults={name:null,value:null},n.isVal=function(t){return this.options.value==t},n._create=function(t,n,i){return i||(i=$("<input />")),i=e.super_.prototype._create.call(this,t,n,i),this.options.name&&i.attr("name",this.options.name),i},n._load=function(t){var e=this.options.name,n=this._parent&&this._parent.options.entity;n&&"undefined"!=typeof n[e]&&(this.options.value=n[e]),t(null)},n._render=function(t){this._elm.val(t.value)},e}),define("core/widgets/ControlsContainer",["core/dcms-ajax","core/widgets/Container","core/widgets/Control"],function(t,e,n){function i(){i.super_.apply(this,arguments),this._controls={}}e.extend(i);var r=i.prototype;return r.defaults={wrapper:null,controls:[],entity:{}},r.data=function(t,e){switch(typeof t){case"undefined":return this.options.entity;case"object":$.extend(this.options.entity,t);break;case"boolean":$.extend(t,this.options.entity,e);break;default:if("undefined"==typeof e)return this.options.entity[t];this.options.entity[t]=e}return this},r.create=function(){var t=i.super_.prototype.create.apply(this,arguments);for(var e in this.options.controls)this.insert(this.options.controls[e]);return this.options.controls=[],t},r.insert=function(e){return e instanceof t.Widget||(e=n.create(e)),e instanceof n&&(e.options.name&&(this._controls[e.options.name]=e),this.options.wrapper&&(e=new this.options.wrapper(e))),i.super_.prototype.insert.call(this,e)},r.remove=function(t){return i.super_.prototype.remove.apply(this,arguments)?(t.options.name&&delete this._controls[t.options.name],this):!1},r._create=function(t,e,n){return n||(n=$("<div />")),i.super_.prototype._create.call(this,t,e,n)},r._load=function(){return this._parent&&this._parent.options.entity&&(this.options.entity=this._parent.options.entity),i.super_.prototype._load.apply(this,arguments)},i}),define("core/widgets/Fieldset",["core/widgets/ControlsContainer"],function(t){function e(){e.super_.apply(this,arguments)}t.extend(e);var n=e.prototype;return n.defaults=$.extend({legend:null},n.defaults),n._create=function(t,n,i){return i||(i=$("<fieldset />")),e.super_.prototype._create.call(this,t,n,i)},n._render=function(t){var n=this._elm.children("legend");t.legend?(n.length||(n=$("<legend />").prependTo(this._elm)),n.text(t.legend)):n.length&&n.remove(),e.super_.prototype._render.call(this,t)},e}),define("core/widgets/Form",["core/widgets/ControlsContainer","core/widgets/Fieldset"],function(t,e){function n(){n.super_.apply(this,arguments)}t.extend(n);var i=n.prototype;return i.defaults={action:"",method:"post",fieldsets:[],fieldset:e},i.create=function(){var t=n.super_.prototype.create.apply(this,arguments);for(var e in this.options.fieldsets)this.insertFieldset(this.options.fieldsets[e]);return this.options.fieldsets=[],t},i.insertFieldset=function(t){return t instanceof e||("undefined"==typeof t.wrapper&&(t.wrapper=this.options.wrapper),t=new this.options.fieldset(t)),this.insert(t)},i._create=function(t,e,i){return i||(i=$("<form />")),i=n.super_.prototype._create.call(this,t,e,i),i.attr("action",this.options.action).attr("method",this.options.method),i},i._load=function(t){var e=this,i=function(i){return i?t(i):(n.super_.prototype._load.call(e,t),void 0)};if(!e.options.api)return i(null),void 0;var r={};"string"==typeof e.options.api?r.url=e.options.api:$.extend(!0,r,e.options.api),r.success=function(t){$.extend(e.options,t),i(null)},r.error=i,DA.api(r)},n}),define("core/widgets/ControlGroup",["core/widgets/ControlsContainer"],function(t){function e(t){Array.isArray(t)||(t=[t]),e.super_.call(this,$.extend({controls:t},t[0].options))}t.extend(e);var n=e.prototype;return n.defaults=$.extend({label:null},n.defaults),n._create=function(t,e,n){return n||(n=$('<div class="control-group" />')),this._container=$('<div class="controls" />').appendTo(n),this.options.wrapperId&&n.attr("id",this.options.wrapperId),this.options.wrapperClass&&n.addClass(this.options.wrapperClass),n},n._render=function(t){var n=this._elm.children("label");t.wrapperLabel||t.label&&null!==t.wrapperLabel?(n.length||(n=$('<label class="control-label" />').prependTo(this._elm)),n.attr("for",t.id||t.name).text(t.wrapperLabel||t.label)):n.length&&n.remove(),e.super_.prototype._render.call(this,t)},e}),define("core/widgets/FormHorizontal",["core/widgets/Form","core/widgets/ControlGroup"],function(t,e){function n(){n.super_.apply(this,arguments)}t.extend(n);var i=n.prototype;return i.defaults=$.extend({},i.defaults,{className:"form-horizontal",wrapper:e}),n}),define("core/widgets/FormActions",["core/dcms-ajax","core/nls/index","core/widgets/Button"],function(t,e,n){function i(){i.super_.apply(this,arguments)}e=e.widgets.FormActions,t.Widget.extend(i);var r=i.prototype;return r.defaults={save:{},saveLabel:e.Save,cancel:{},cancelLabel:e.Cancel,cancelClick:null,actions:null},r._create=function(t,e,n){return n||(n=$('<div class="form-actions" />')),i.super_.prototype._create.call(this,t,e,n)},r._load=function(t){t(null)},r._render=function(t){this._elm.empty();var e=t.actions;e||(e=[],t.save&&e.push($.extend({type:"submit",className:"btn-primary",label:t.saveLabel},t.save)),t.cancel&&e.push($.extend({label:t.cancelLabel,click:t.cancelClick},t.cancel)));for(var i in e)this._elm.append(n.create(e[i])).append(" ")},i}),define("core/widgets/MultiControl",["core/widgets/Control"],function(t){function e(){e.super_.apply(this,arguments)}t.extend(e);var n=e.prototype;return n.isVal=function(t){return Array.isArray(this.options.value)?~this.options.value.indexOf(t):e.super_.prototype.isVal.apply(this,arguments)},n._render=function(){throw new Error("Unimplement method")},e}),define("core/widgets/Input",["core/widgets/Control"],function(t){function e(){e.super_.apply(this,arguments)}t.extend(e);var n=e.prototype;return t.types.default=t.types.input=e,n.defaults={type:"text",maxlength:null,placeholder:null,dir:null,spellcheck:null,required:null,autocomplete:null,autofocus:null},n._create=function(t,n,i){return i||(i=$("<input />")),i=e.super_.prototype._create.call(this,t,n,i),i.attr("type",this.options.type),this.options.dir&&i.attr("dir",this.options.dir),null!==this.options.spellcheck&&i.prop("spellcheck",this.options.spellcheck),this.options.maxlength&&i.attr("maxlength",this.options.maxlength),this.options.placeholder&&i.attr("placeholder",this.options.placeholder),null!==this.options.required&&i.prop("required",this.options.required),null!==this.options.autocomplete&&i.prop("autocomplete",this.options.autocomplete),null!==this.options.autofocus&&i.prop("autofocus",this.options.autofocus),i},e}),define("core/widgets/Checkbox",["core/widgets/Control","core/widgets/Input"],function(t,e){function n(){n.super_.apply(this,arguments)}t.extend(n);var i=n.prototype;return t.types.checkbox=n,i.defaults={type:"checkbox",name:null,value:null,wrapperLabel:null,checkedValue:1,uncheckValue:0},i._create=function(){var t=$('<label class="checkbox" />').attr("for",this.options.id);return this.hidden=new e(this._getHiddenOptions(this.options)),this.hidden.create(t,this),this.input=new e(this.options),this.input.create(t,this),this.options.label&&t.append(" "+n.escape(this.options.label)),t
},i._destroy=function(){this.hidden.destroy(),this.hidden=null,this.input.destroy(),this.input=null,n.super_.prototype._destroy.apply(this,arguments)},i._getHiddenOptions=function(t){return{type:"hidden",id:null,name:t.name,value:t.uncheckValue}},i._render=function(t){this.hidden.render(this._getHiddenOptions(t)),this.input.render(t)},n}),define("core/widgets/Select",["core/dcms-ajax","core/widgets/Control","core/widgets/MultiControl"],function(t,e,n){function i(){i.super_.apply(this,arguments)}n.extend(i);var r=i.prototype;return e.types.select=i,r.defaults={name:null,value:null,options:[],optionGroups:[]},r._create=function(t,e,n){return n||(n=$("<select />")),n=i.super_.prototype._create.call(this,t,e,n),n.attr("type",this.options.type),n},r._render=function(e){this._elm.empty();for(var n in e.optionGroups){var i=t.Widget.configElm($("<optgroup />"),this.options.optionGroups[n]).appendTo(this._elm).attr("label",e.optionGroups[n].label||n);this._renderOptions(e.optionGroups[n].options||e.optionGroups[n],i)}this._renderOptions(e.options,this._elm)},r._renderOptions=function(e,n){for(var i in e){var r=e[i].label?e[i]:{label:e[i]},o=r.value||i;t.Widget.configElm($("<option />"),r).appendTo(n).attr("value",o).prop("selected",this.isVal(o)).text(r.label)}},i}),define("core/widgets/TextArea",["core/widgets/Control","core/widgets/Input"],function(t,e){function n(){n.super_.apply(this,arguments)}e.extend(n);var i=n.prototype;return t.types.textarea=n,i.defaults={name:null,value:null,cols:null,rows:null,wrap:null},i._create=function(t,e,i){return i||(i=$("<textarea />")),i=n.super_.prototype._create.call(this,t,e,i),i.attr("type",this.options.type),this.options.cols&&i.attr("cols",this.options.cols),this.options.rows&&i.attr("rows",this.options.rows),this.options.wrap&&i.attr("wrap",this.options.wrap),i},n}),define("core/widgets/HtmlEditor",["core/widgets/Control","core/widgets/TextArea"],function(t,e){function n(){n.super_.apply(this,arguments)}e.extend(n);var i=n.prototype;return t.types.htmleditor=n,n.launchEditor=function(t,e){require(["tinymce","jquery-tinymce"],function(){tinymce.dom.Event.domLoaded=!0,t.tinymce(e)})},i.defaults={cols:null,rows:null,wrap:null,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",editor:{}},i._getEditorOptions=function(t){return $.extend({},t,t.editor)},i._render=function(t){this._elm.val(t.value),n.launchEditor(this._elm,this._getEditorOptions(t))},n}),define("core/widgets/InputFile",["core/widgets/Control","core/nls/index","core/widgets/Button","core/widgets/Input","core/widgets/ProgressBar"],function(t,e,n,i,r){function o(){o.super_.apply(this,arguments)}e=e.widgets.InputFile,t.extend(o);var s=o.prototype;return t.types.inputfile=o,o.setupPlugin=function(t,e,n){require(["jquery-iframe-transport","jquery-fileupload"],function(){t.fileupload($.extend({dataType:"json",url:e.api,start:function(){n.render({failed:!1,active:!0})},stop:function(){n.render({active:!1})},progressall:function(t,e){n.render({percentage:e.loaded/e.total})},done:function(t,i){var r=n.options.value;e.multiple?r=Array.isArray(n.options.value)?r.concat(i.result):i.result:(r&&o.deleteFile(r,n,$.noop),r=i.result[0]),n.render({value:r,percentage:0})},fail:function(){n.render({failed:!0})}},e.plugin))})},o.deleteFile=function(t,e,n){var i=t.value||t.url||t;$.ajax({type:"delete",dataType:"json",url:e.options.api,data:{file:i},success:function(t){n(t===!0?null:-1)},error:function(t){n(t||-1)}})},s.defaults={btnClass:"btn-success",btnIcon:"icon-upload icon-white",btnLabel:null,progressClass:"",progressActiveClass:"progress-striped active",barClass:"",barFailedClass:"bar-danger",imageMaxWidth:80,imageMaxHeight:80,percentage:0,multiple:!1,multipleBrackets:"[]",api:"/api/files",active:!1,failed:!1,plugin:{},button:{},progress:{},file:{},hidden:{}},s.create=function(){var t=o.super_.prototype.create.apply(this,arguments);return o.setupPlugin(this.file._elm,this.options,this),t},s._create=function(t,e,s){s||(s=$('<div class="widget-fileinput" />')),s=o.super_.prototype._create.call(this,t,e,s),this.button=new n(this._getButtonOptions(this.options));var a=this.button.create(s,this);return this.file=new i(this._getFileOptions(this.options)),this.file.create(a,this),this.progress=new r(this._getProgressOptions(this.options)),this.progress.create(s,this),this._files=$('<div class="files" />').appendTo(s),s},s._destroy=function(){this.button.destroy(),this.button=null,this.file.destroy(),this.file=null,$.each(this.hiddens,function(t,e){e.destroy()}),this.hiddens=[],o.super_.prototype._destroy.apply(this,arguments)},s._getButtonOptions=function(t){return $.extend(!0,{type:"span",label:t.btnLabel||(t.multiple?e.selectFiles:e.selectFile),className:t.btnClass,icon:t.btnIcon},t.button)},s._getFileOptions=function(t){return $.extend(!0,{type:"file",name:this.getInputName(),className:"file-input",prop:{multiple:t.multiple}},t.file)},s._getProgressOptions=function(t){return $.extend(!0,{className:t.active?t.progressActiveClass:t.progressClass,barClass:t.failed?t.barFailedClass:t.barClass,percentage:t.percentage},t.progress)},s.getInputName=function(){var t=this.options.name;return this.options.multiple&&this.options.multipleBrackets&&(t+=this.options.multipleBrackets),t},s._render=function(t){var e=this;o.super_.prototype._render.apply(this,arguments),this.button.render(this._getButtonOptions(t)),this.progress.render(this._getProgressOptions(t)),this.file.render(this._getFileOptions(t)),this._files.empty(),t.multiple?Array.isArray(t.value)&&$.each(t.value,function(t,n){e._renderFile(n,t)}):t.value&&this._renderFile(t.value)},s._renderFile=function(t,i){var r=this,s=t.url||t,a=t.name||s.match(/[^\/]+$/)[0],u=t.value||t.url,c=t.type&&"image/"===t.type.substr(0,6)||null!==s.match(/\.(png|jpe?g|gif)$/i),l=$('<div class="file" />').appendTo(this._files);$('<input type="hidden" />').appendTo(l).attr({name:this.getInputName(),value:u}),c&&$('<a class="file-image" target="_blank" />').attr("href",s).appendTo(l).append($("<img />").attr({src:s,alt:a}).css({maxWidth:this.options.imageMaxWidth,maxHeight:this.options.imageMaxHeight})),$('<a class="file-name" target="_blank" />').attr("href",s).text(a).appendTo(l),n.create({className:"btn-danger btn-mini",icon:"icon-trash icon-white",label:e.del,click:function(){l.slideDown(),o.deleteFile(t,r,function(t){return t?(l.show(),void 0):(l.remove(),r.options.value&&("undefined"!=typeof i?delete r.options.value[i]:r.options.value=null),void 0)})}}).appendTo(l)},o}),define("core/index",["core/dcms-ajax","core/plugins/layout","core/widgets/Toolbar","core/widgets/Button","core/widgets/ButtonGroup","core/widgets/Nav","core/widgets/Dropdown","core/widgets/NavBar","core/widgets/ProgressBar","core/widgets/Tabs","core/widgets/Tab","core/widgets/Table","core/widgets/Browser","core/widgets/Pagination","core/widgets/Container","core/widgets/Fieldset","core/widgets/Form","core/widgets/FormHorizontal","core/widgets/ControlGroup","core/widgets/FormActions","core/widgets/Control","core/widgets/MultiControl","core/widgets/Input","core/widgets/Checkbox","core/widgets/Select","core/widgets/TextArea","core/widgets/HtmlEditor","core/widgets/InputFile"],function(t,e,n,i,r,o,s,a,u,c,l,p,d,h,f,g,m,v,y,_,b,w,x,C,$,k,L,P){return t.registry.set("plugins.layout",{_path:!1}),t.plugins.layout=e,t.Widget.Toolbar=n,t.Widget.Button=i,t.Widget.ButtonGroup=r,t.Widget.Nav=o,t.Widget.Dropdown=s,t.Widget.NavBar=a,t.Widget.ProgressBar=u,t.Widget.Tabs=c,t.Widget.Tab=l,t.Widget.Table=p,t.Widget.Browser=d,t.Widget.Pagination=h,t.Widget.Container=f,t.Widget.Fieldset=g,t.Widget.Form=m,t.Widget.FormHorizontal=v,t.Widget.ControlGroup=y,t.Widget.FormActions=_,t.Widget.Control=b,t.Widget.MultiControl=w,t.Widget.Input=x,t.Widget.Checkbox=C,t.Widget.Select=$,t.Widget.TextArea=k,t.Widget.HtmlEditor=L,t.Widget.InputFile=P,t});